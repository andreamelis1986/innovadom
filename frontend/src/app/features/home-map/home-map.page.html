<div class="layout-container" [class.collapsed]="isCollapsed">
  <!-- Topbar -->
  <header class="topbar">
    <div class="topbar-left" *ngIf="!isCollapsed">
      <div class="logo">DomusControl</div>
      <nav class="nav">
        <button class="nav-btn active">Mappa</button>
        <button class="nav-btn">Dispositivi</button>
        <button class="nav-btn">Scene</button>
        <button class="nav-btn">Routine</button>
      </nav>
    </div>

    <div class="topbar-right">
      <button class="icon-btn">🏠</button>
      <button class="icon-btn">➕</button>
      <button class="icon-btn">👤</button>
      <button class="icon-btn">⚙️</button>
      <button class="icon-btn toggle-bars" (click)="isCollapsed = !isCollapsed">
        <span *ngIf="isCollapsed">⮞</span>
        <span *ngIf="!isCollapsed">⮜</span>
      </button>
    </div>
  </header>

  <!-- Layout principale -->
  <div class="layout">
    <!-- Sidebar -->
    <aside class="left" *ngIf="!isCollapsed">
      <div class="panel">
        <div class="panel-title">Home Status</div>
        <div class="stat"><div>Luci</div><div class="val">{{ homeStatus.lightsOn }} On</div></div>
        <div class="stat"><div>Temperatura</div><div class="val">{{ homeStatus.temperature }} °C</div></div>
        <div class="stat"><div>Energia</div><div class="val">{{ homeStatus.energyKwh }} kWh</div></div>
        <div class="stat"><div>Telecamere</div><div class="val">{{ homeStatus.camerasOn }} On</div></div>
      </div>

      <div class="panel actions">
        <div class="panel-title">Scorciatoie</div>
        <button class="action">Movie Time</button>
        <button class="action">Workout</button>
        <button class="action">Party</button>
      </div>
    </aside>

    <!-- Centro -->
    <main class="center">
      <div class="map-wrap">
        <img class="map" src="assets/planimetria_modern_5.png" alt="Plan" />
        
        <ng-container *ngFor="let dev of devices">
          <div 
            class="icon" 
            [ngClass]="[dev.type, dev.status ? 'on' : 'off']"
            [style.left.%]="dev.xPct"
            [style.top.%]="dev.yPct"
            (click)="toggleDevice(dev)"
            [title]="dev.name">
            {{ iconFor(dev.type) }}
            <div class="pulse" *ngIf="dev.status"></div>
          </div>
        </ng-container>
      </div>
    </main>
  </div>
</div>
